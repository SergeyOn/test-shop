import React from 'react';
import withPageData from 'components/HOC/withPageData.jsx';
import { Redirect, Link } from 'react-router-dom';
import { LinkParse } from 'utils/LinkParse';
import { Card, Row, Col, Button } from 'antd';

const ProductsPage = props => {
  const { Meta } = Card;
  const { pageData, pageLoaded, pageError } = props;
  if (pageError) return <Redirect to='/404' />
  if (!pageLoaded) return <h1>loading</h1>
  return (
    <div>
      <Row gutter={[{ xs: 8, sm: 16, md: 24, lg: 32 }, 20]}>
      {pageData.products.length && 
        pageData.products.map((e,i) => {
        return (
          <Col className="gutter-row" xs={{ span: 12 }} lg={{ span: 6 }} key={e.name}>
            <Link to={LinkParse(e.product_url)}>
              <Card
              hoverable
              cover={<img src={`https://picsum.photos/id/${Math.ceil(Math.random() * 99)}/400/500`} alt={e.name} />}
              >
              <Meta title={e.name} description={e.product_url && LinkParse(e.product_url)} />
            </Card>
            </Link>
        </Col>
        )})
      }
  </Row>
      <Row>
        {pageData.meta.previous_url && (
            <Button type="primary">
              <Link to={LinkParse(pageData.meta.previous_url)}>prev</Link>
            </Button>
            ) 
        }
        {pageData.meta.next_url && (
            <Button type="primary">
              <Link to={LinkParse(pageData.meta.next_url)}>next</Link>
            </Button>
          ) 
        }
      </Row>
    </div>
  )
}

export default withPageData()(ProductsPage);